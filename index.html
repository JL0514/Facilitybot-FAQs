<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agila Subic FAQ - Frequently Asked Questions</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#2563eb',
                        secondary: '#6b7280',
                        accent: '#059669'
                    }
                }
            }
        }
    </script>
    <style>
        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }
        .accordion-content.open {
            max-height: 2000px;
            transition: max-height 0.5s ease-in;
        }
        .card-hover {
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .card-hover:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .hse-popup {
            z-index: 9999;
            backdrop-filter: blur(5px);
        }
        .hse-image {
            max-width: 90vw;
            max-height: 80vh;
            object-fit: contain;
        }
        .progress-bar {
            transition: width 0.1s linear;
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
        .fade-out {
            animation: fadeOut 0.3s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }
        @keyframes fadeOut {
            from { opacity: 1; transform: scale(1); }
            to { opacity: 0; transform: scale(0.95); }
        }
        .settings-panel {
            transform: translateX(100%);
            transition: transform 0.3s ease-in-out;
        }
        .settings-panel.open {
            transform: translateX(0);
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- HSE Bulletins Popup -->
    <div id="hsePopup" class="fixed inset-0 bg-black bg-opacity-75 hse-popup hidden flex items-center justify-center">
        <div class="relative bg-white rounded-lg p-4 max-w-4xl w-full mx-4 fade-in">
            <!-- Close Button -->
            <button onclick="closeHSEPopup()" class="absolute top-2 right-2 z-10 bg-red-500 hover:bg-red-600 text-white rounded-full w-8 h-8 flex items-center justify-center transition-colors">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
            </button>
            
            <!-- Image Container -->
            <div class="text-center">
                <img id="hseImage" src="" alt="HSE Bulletin" class="hse-image mx-auto rounded-lg shadow-lg">
                <div class="mt-4 flex items-center justify-between">
                    <div class="text-sm text-gray-600">
                        <span id="currentImageIndex">1</span> of <span id="totalImages">12</span>
                    </div>
                    <div class="flex items-center space-x-2">
                        <button onclick="previousImage()" class="bg-gray-200 hover:bg-gray-300 text-gray-700 px-3 py-1 rounded text-sm">Previous</button>
                        <button onclick="toggleAutoAdvance()" id="autoAdvanceBtn" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded text-sm">Pause</button>
                        <button onclick="nextImage()" class="bg-gray-200 hover:bg-gray-300 text-gray-700 px-3 py-1 rounded text-sm">Next</button>
                    </div>
                </div>
                <!-- Progress Bar -->
                <div class="mt-2 w-full bg-gray-200 rounded-full h-1">
                    <div id="progressBar" class="bg-blue-500 h-1 rounded-full progress-bar" style="width: 0%"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Settings Button (Fixed position) -->
    <button onclick="openSettings()" class="fixed bottom-4 right-4 bg-gray-600 hover:bg-gray-700 text-white p-3 rounded-full shadow-lg z-50">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
        </svg>
    </button>

    <!-- Settings Panel -->
    <div id="settingsPanel" class="fixed top-0 right-0 h-full w-80 bg-white shadow-xl settings-panel z-50">
        <div class="p-6">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-lg font-semibold text-gray-900">Settings</h3>
                <button onclick="closeSettings()" class="text-gray-500 hover:text-gray-700">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>

            <!-- Password Section -->
            <div id="passwordSection" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Enter Password</label>
                    <input type="password" id="settingsPassword" placeholder="Enter password" class="w-full px-3 py-2 text-base border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <button onclick="verifyPassword()" class="w-full bg-blue-500 hover:bg-blue-600 text-white py-2 rounded-lg">Access Settings</button>
                <div id="passwordError" class="text-red-500 text-sm hidden">Incorrect password</div>
            </div>

            <!-- Settings Content (Hidden initially) -->
            <div id="settingsContent" class="space-y-6 hidden">
                <div>
                    <h4 class="font-medium text-gray-900 mb-3">HSE Bulletins Management</h4>
                    
                    <!-- Upload Picture File -->
                    <div class="space-y-3">
                        <label class="block text-sm font-medium text-gray-700">Upload New HSE Bulletin Picture</label>
                        <input type="file" id="imageUpload" accept="image/*" class="w-full px-3 py-2 text-base border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <button onclick="uploadImage()" class="w-full bg-green-500 hover:bg-green-600 text-white py-2 rounded-lg">Upload Picture</button>
                        <div id="uploadStatus" class="text-sm text-gray-600 hidden"></div>
                    </div>

                    <!-- Add New Image URL (alternative method) -->
                    <div class="space-y-3 mt-4 pt-4 border-t border-gray-200">
                        <label class="block text-sm font-medium text-gray-700">Or Add Image URL</label>
                        <input type="url" id="newImageUrl" placeholder="https://example.com/image.jpg" class="w-full px-3 py-2 text-base border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <button onclick="addNewImage()" class="w-full bg-blue-500 hover:bg-blue-600 text-white py-2 rounded-lg">Add Image URL</button>
                    </div>

                    <!-- Export/Import Section -->
                    <div class="mt-6 pt-4 border-t border-gray-200">
                        <h5 class="font-medium text-gray-900 mb-3">Backup & Restore</h5>
                        <div class="space-y-2">
                            <button onclick="exportImages()" class="w-full bg-purple-500 hover:bg-purple-600 text-white py-2 rounded-lg text-sm">
                                📥 Export Images List
                            </button>
                            <input type="file" id="importFile" accept=".json" class="hidden" onchange="handleImportFile(this)">
                            <button onclick="document.getElementById('importFile').click()" class="w-full bg-orange-500 hover:bg-orange-600 text-white py-2 rounded-lg text-sm">
                                📤 Import Images List
                            </button>
                            <button onclick="resetToDefault()" class="w-full bg-gray-500 hover:bg-gray-600 text-white py-2 rounded-lg text-sm">
                                🔄 Reset to Default
                            </button>
                        </div>
                        <div class="mt-2 p-2 bg-yellow-50 border border-yellow-200 rounded text-xs text-gray-600">
                            💡 Export your images list to save your uploads. Import to restore them later.
                        </div>
                    </div>

                    <!-- Auto-advance Settings -->
                    <div class="mt-6">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Auto-advance Duration (seconds)</label>
                        <input type="number" id="advanceDuration" value="8" min="3" max="30" class="w-full px-3 py-2 text-base border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <button onclick="updateDuration()" class="w-full mt-2 bg-blue-500 hover:bg-blue-600 text-white py-2 rounded-lg">Update Duration</button>
                    </div>

                    <!-- Storage Status -->
                    <div class="mt-4 p-3 rounded-lg" id="storageStatus">
                        <div class="flex items-center space-x-2">
                            <div class="w-2 h-2 rounded-full" id="storageIndicator"></div>
                            <span class="text-xs" id="storageText">Checking storage...</span>
                        </div>
                    </div>

                    <!-- Current Images List -->
                    <div class="mt-6">
                        <h5 class="font-medium text-gray-900 mb-2">Current HSE Bulletins</h5>
                        <div id="imagesList" class="space-y-2 max-h-40 overflow-y-auto">
                            <!-- Images will be listed here -->
                        </div>
                    </div>

                    <!-- Show Popup Button -->
                    <button onclick="showHSEPopup()" class="w-full bg-purple-500 hover:bg-purple-600 text-white py-2 rounded-lg">Show HSE Bulletins</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Header Section -->
    <div class="bg-white border-b border-gray-200">
        <div class="container mx-auto px-4 py-12 max-w-6xl">
            <div class="text-center">
                <h1 class="text-4xl font-bold text-gray-900 mb-4">Agila Subic FAQ</h1>
                <p class="text-lg text-gray-600 mb-6">Comprehensive guide to facility requests and procedures</p>
                <div class="w-24 h-1 bg-blue-600 mx-auto"></div>
            </div>
        </div>
    </div>

    <div class="container mx-auto px-4 py-8 max-w-6xl">
        <!-- Search Section -->
        <div class="mb-12">
            <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
                <h2 class="text-xl font-semibold text-gray-900 mb-4 text-center">Search FAQs</h2>
                <div class="relative max-w-lg mx-auto">
                    <input 
                        type="text" 
                        id="searchInput" 
                        placeholder="Search questions or topics..." 
                        class="w-full px-4 py-3 pl-12 text-base border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                        autocomplete="off"
                    >
                    <svg class="absolute left-4 top-3.5 w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                    </svg>
                    <button id="clearSearch" class="absolute right-3 top-3 text-gray-400 hover:text-gray-600 hidden">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
                <div id="searchResults" class="mt-4 text-center text-gray-600 hidden">
                    <span id="resultCount">0</span> result(s) found
                </div>
                <div id="noResults" class="mt-4 text-center text-gray-500 hidden">
                    <p>No FAQs found matching your search. Try different keywords.</p>
                </div>
            </div>
        </div>

        <!-- For Subtenants Section -->
        <div class="mb-16">
            <div class="text-center mb-8">
                <h2 class="text-2xl font-bold text-gray-900 mb-2">For Subtenants</h2>
                <div class="w-16 h-0.5 bg-blue-600 mx-auto"></div>
            </div>
            
            <div class="grid lg:grid-cols-3 md:grid-cols-2 gap-6">
                <!-- Service Requests Card -->
                <div class="bg-white border border-gray-200 rounded-lg shadow-sm overflow-hidden card-hover cursor-pointer" onclick="toggleAccordion('subtenant-service')">
                    <div class="p-6">
                        <div class="flex items-center mb-4">
                            <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center mr-3">
                                <svg class="w-4 h-4 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                </svg>
                            </div>
                            <h3 class="text-lg font-semibold" style="color: #00072d;">Service Requests</h3>
                        </div>
                        <p class="text-gray-600 mb-4 text-sm">Repair & maintenance filing process</p>
                        
                        <div class="flex justify-between items-center">
                            <span class="font-medium text-gray-700">How to file a Service Request?</span>
                            <svg id="arrow-subtenant-service" class="w-5 h-5 transition-transform duration-300 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                            </svg>
                        </div>
                        
                        <div id="subtenant-service" class="accordion-content">
                            <div class="mt-6 pt-4 border-t border-gray-200">
                                <div class="space-y-4">
                                    <div>
                                        <h4 class="font-semibold text-gray-900 mb-2">Creating a Service Request</h4>
                                        <div class="bg-gray-50 p-4 rounded-lg">
                                            <p class="text-sm">Go to <strong>Agila Subic Bot → Menu → Service Request → Create Service Request → Select "Service Request."</strong></p>
                                        </div>
                                        <div class="flex items-start space-x-2 mt-2">
                                            <span class="text-blue-600">•</span>
                                            <p class="text-sm text-gray-700">Use this if you need assistance from our team.</p>
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <h4 class="font-semibold text-gray-900 mb-2">Viewing Your Requests</h4>
                                        <div class="bg-gray-50 p-4 rounded-lg">
                                            <p class="text-sm">Go to <strong>Agila Subic Bot → Menu → Service Request → View my Request</strong></p>
                                        </div>
                                        <div class="flex items-start space-x-2 mt-2">
                                            <span class="text-blue-600">•</span>
                                            <p class="text-sm text-gray-700">Track the status and progress of your submitted requests.</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Access Requests Card -->
                <div class="bg-white border border-gray-200 rounded-lg shadow-sm overflow-hidden card-hover cursor-pointer" onclick="toggleAccordion('subtenant-access')">
                    <div class="p-6">
                        <div class="flex items-center mb-4">
                            <div class="w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center mr-3">
                                <svg class="w-4 h-4 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"></path>
                                </svg>
                            </div>
                            <h3 class="text-lg font-semibold" style="color: #00072d;">Access Requests</h3>
                        </div>
                        <p class="text-gray-600 mb-4 text-sm">Visitor entry & gatepass procedures</p>
                        
                        <div class="flex justify-between items-center">
                            <span class="font-medium text-gray-700">How to file an Access Request?</span>
                            <svg id="arrow-subtenant-access" class="w-5 h-5 transition-transform duration-300 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                            </svg>
                        </div>
                        
                        <div id="subtenant-access" class="accordion-content">
                            <div class="mt-6 pt-4 border-t border-gray-200">
                                <div class="space-y-4">
                                    <div>
                                        <h4 class="font-semibold text-gray-900 mb-2">Creating an Access Request</h4>
                                        <div class="bg-gray-50 p-4 rounded-lg">
                                            <p class="text-sm">Go to <strong>Agila Subic Bot → Menu → Service Request → Create Service Request → Select "Visitor Entry Request / Delivery."</strong></p>
                                        </div>
                                        <div class="flex items-start space-x-2 mt-2">
                                            <span class="text-green-600">•</span>
                                            <p class="text-sm text-gray-700">This applies to guests, visitors, vendors, suppliers, and contractors.</p>
                                        </div>
                                        <div class="bg-yellow-50 border border-yellow-200 p-3 rounded-lg flex items-start space-x-2 mt-2">
                                            <span class="text-yellow-600">⚠️</span>
                                            <p class="text-sm text-gray-700">Make sure to read and follow the instructions to avoid delays at the gate.</p>
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <h4 class="font-semibold text-gray-900 mb-2">Viewing Your Requests</h4>
                                        <div class="bg-gray-50 p-4 rounded-lg">
                                            <p class="text-sm">Go to <strong>Agila Subic Bot → Menu → Service Request → View my Request</strong></p>
                                        </div>
                                        <div class="flex items-start space-x-2 mt-2">
                                            <span class="text-green-600">•</span>
                                            <p class="text-sm text-gray-700">Track the status and progress of your submitted access requests.</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Compliance Rules Card -->
                <div class="bg-white border border-gray-200 rounded-lg shadow-sm overflow-hidden card-hover cursor-pointer" onclick="toggleAccordion('subtenant-rules')">
                    <div class="p-6">
                        <div class="flex items-center mb-4">
                            <div class="w-8 h-8 bg-red-100 rounded-lg flex items-center justify-center mr-3">
                                <svg class="w-4 h-4 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                            </div>
                            <h3 class="text-lg font-semibold" style="color: #00072d;">Compliance Rules</h3>
                        </div>
                        <p class="text-gray-600 mb-4 text-sm">Essential guidelines to follow</p>
                        
                        <div class="flex justify-between items-center">
                            <span class="font-medium text-gray-700">What rules must I follow?</span>
                            <svg id="arrow-subtenant-rules" class="w-5 h-5 transition-transform duration-300 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                            </svg>
                        </div>
                        
                        <div id="subtenant-rules" class="accordion-content">
                            <div class="mt-6 pt-4 border-t border-gray-200">
                                <div class="space-y-3">
                                    <div class="flex items-start space-x-3">
                                        <div class="w-2 h-2 bg-gray-400 rounded-full mt-2"></div>
                                        <p class="text-sm text-gray-700">Always carry a valid Company ID or government-issued ID</p>
                                    </div>
                                    <div class="flex items-start space-x-3">
                                        <div class="w-2 h-2 bg-gray-400 rounded-full mt-2"></div>
                                        <p class="text-sm text-gray-700">Comply with dress code and wear PPE in operational zones</p>
                                    </div>
                                    <div class="flex items-start space-x-3">
                                        <div class="w-2 h-2 bg-gray-400 rounded-full mt-2"></div>
                                        <p class="text-sm text-gray-700">Use registered plate numbers in requests</p>
                                    </div>
                                    <div class="bg-red-50 border border-red-200 p-3 rounded-lg">
                                        <p class="text-sm font-medium text-red-800">❌ Any discrepancies = entry denial or delay</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Gatepass Card -->
                <div class="bg-white border border-gray-200 rounded-lg shadow-sm overflow-hidden card-hover cursor-pointer" onclick="toggleAccordion('subtenant-gatepass')">
                    <div class="p-6">
                        <div class="flex items-center mb-4">
                            <div class="w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center mr-3">
                                <svg class="w-4 h-4 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
                                </svg>
                            </div>
                            <h3 class="text-lg font-semibold" style="color: #00072d;">Gatepass Requests</h3>
                        </div>
                        <p class="text-gray-600 mb-4 text-sm">Pull-out procedures</p>
                        
                        <div class="flex justify-between items-center">
                            <span class="font-medium text-gray-700">How to request a Gatepass for Pull-Out?</span>
                            <svg id="arrow-subtenant-gatepass" class="w-5 h-5 transition-transform duration-300 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                            </svg>
                        </div>
                        
                        <div id="subtenant-gatepass" class="accordion-content">
                            <div class="mt-6 pt-4 border-t border-gray-200">
                                <div class="space-y-3">
                                    <div class="bg-gray-50 p-4 rounded-lg">
                                        <p class="text-sm">Go to <strong>Agila Subic Bot → Menu → Service Request → Create Service Request → Select "Gatepass for Pull-Out."</strong></p>
                                    </div>
                                    <div class="flex items-start space-x-2">
                                        <span class="text-purple-600">•</span>
                                        <p class="text-sm text-gray-700">Ensure that all guidelines are followed; mismatched or incomplete details may cause delays.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- HSE Induction Card -->
                <div class="bg-white border border-gray-200 rounded-lg shadow-sm overflow-hidden card-hover cursor-pointer" onclick="toggleAccordion('subtenant-hse')">
                    <div class="p-6">
                        <div class="flex items-center mb-4">
                            <div class="w-8 h-8 bg-orange-100 rounded-lg flex items-center justify-center mr-3">
                                <svg class="w-4 h-4 text-orange-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"></path>
                                </svg>
                            </div>
                            <h3 class="text-lg font-semibold" style="color: #00072d;">HSE Induction</h3>
                        </div>
                        <p class="text-gray-600 mb-4 text-sm">Safety training requests</p>
                        
                        <div class="flex justify-between items-center">
                            <span class="font-medium text-gray-700">How to request HSE Induction?</span>
                            <svg id="arrow-subtenant-hse" class="w-5 h-5 transition-transform duration-300 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                            </svg>
                        </div>
                        
                        <div id="subtenant-hse" class="accordion-content">
                            <div class="mt-6 pt-4 border-t border-gray-200">
                                <div class="space-y-3">
                                    <p class="text-sm text-gray-700">Required for contractors working on-site, or visitors/vendors who will stay frequently or long-term.</p>
                                    <div class="bg-gray-50 p-4 rounded-lg">
                                        <p class="text-sm">Go to <strong>Agila Subic Bot → Menu → Service Request → Create Service Request → Select "HSE Induction."</strong></p>
                                    </div>
                                    <div class="flex items-start space-x-2">
                                        <span class="text-orange-600">•</span>
                                        <p class="text-sm text-gray-700">Enter all names individually, as this serves as official attendance.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Approvals Card -->
                <div class="bg-white border border-gray-200 rounded-lg shadow-sm overflow-hidden card-hover cursor-pointer" onclick="toggleAccordion('subtenant-approvals')">
                    <div class="p-6">
                        <div class="flex items-center mb-4">
                            <div class="w-8 h-8 bg-teal-100 rounded-lg flex items-center justify-center mr-3">
                                <svg class="w-4 h-4 text-teal-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                            </div>
                            <h3 class="text-lg font-semibold" style="color: #00072d;">Request Approvals</h3>
                        </div>
                        <p class="text-gray-600 mb-4 text-sm">Who approves what</p>
                        
                        <div class="flex justify-between items-center">
                            <span class="font-medium text-gray-700">Who approves my requests?</span>
                            <svg id="arrow-subtenant-approvals" class="w-5 h-5 transition-transform duration-300 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                            </svg>
                        </div>
                        
                        <div id="subtenant-approvals" class="accordion-content">
                            <div class="mt-6 pt-4 border-t border-gray-200">
                                <div class="space-y-3">
                                    <p class="text-sm text-gray-700">Tenant requests are reviewed by <strong>CBRE</strong> and finalized by <strong>AGILA Subic</strong>.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- For Contractors Section -->
        <div class="mb-16">
            <div class="text-center mb-8">
                <h2 class="text-2xl font-bold text-gray-900 mb-2">For Contractors / Vendors / Suppliers</h2>
                <div class="w-16 h-0.5 bg-blue-600 mx-auto"></div>
            </div>
            
            <div class="grid lg:grid-cols-3 md:grid-cols-2 gap-6">
                <!-- Work Access Card -->
                <div class="bg-white border border-gray-200 rounded-lg shadow-sm overflow-hidden card-hover cursor-pointer" onclick="toggleAccordion('contractor-access')">
                    <div class="p-6">
                        <div class="flex items-center mb-4">
                            <div class="w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center mr-3">
                                <svg class="w-4 h-4 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 9l3 3-3 3m13 0h-3m-3-3h3m-3 0v6a2 2 0 01-2 2H7a2 2 0 01-2-2V7a2 2 0 012-2h6m3 3V7a2 2 0 012-2h3"></path>
                                </svg>
                            </div>
                            <h3 class="text-lg font-semibold" style="color: #00072d;">Work Access</h3>
                        </div>
                        <p class="text-gray-600 mb-4 text-sm">Entry & delivery procedures</p>
                        
                        <div class="flex justify-between items-center">
                            <span class="font-medium text-gray-700">How to request access for work?</span>
                            <svg id="arrow-contractor-access" class="w-5 h-5 transition-transform duration-300 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                            </svg>
                        </div>
                        
                        <div id="contractor-access" class="accordion-content">
                            <div class="mt-6 pt-4 border-t border-gray-200">
                                <div class="space-y-3">
                                    <p class="text-sm text-gray-700">Contractors must be endorsed by the tenant and submit an Access Request via Agila Subic Bot (FacilityBot in Viber).</p>
                                    <div class="flex items-start space-x-2">
                                        <span class="text-green-600">•</span>
                                        <p class="text-sm text-gray-700">If you scan the QR code, you may file your own request.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Compliance Card -->
                <div class="bg-white border border-gray-200 rounded-lg shadow-sm overflow-hidden card-hover cursor-pointer" onclick="toggleAccordion('contractor-compliance')">
                    <div class="p-6">
                        <div class="flex items-center mb-4">
                            <div class="w-8 h-8 bg-orange-100 rounded-lg flex items-center justify-center mr-3">
                                <svg class="w-4 h-4 text-orange-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                            </div>
                            <h3 class="text-lg font-semibold" style="color: #00072d;">Compliance</h3>
                        </div>
                        <p class="text-gray-600 mb-4 text-sm">Requirements & procedures</p>
                        
                        <div class="flex justify-between items-center">
                            <span class="font-medium text-gray-700">What must I comply with?</span>
                            <svg id="arrow-contractor-compliance" class="w-5 h-5 transition-transform duration-300 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                            </svg>
                        </div>
                        
                        <div id="contractor-compliance" class="accordion-content">
                            <div class="mt-6 pt-4 border-t border-gray-200">
                                <div class="space-y-3">
                                    <ul class="space-y-2">
                                        <li class="flex items-start space-x-2">
                                            <span class="text-gray-400">•</span>
                                            <span class="text-sm text-gray-700">Process Visitor Entry Requests and Gatepasses online via FacilityBot</span>
                                        </li>
                                        <li class="flex items-start space-x-2">
                                            <span class="text-gray-400">•</span>
                                            <span class="text-sm text-gray-700">Bring valid company or government-issued IDs</span>
                                        </li>
                                        <li class="flex items-start space-x-2">
                                            <span class="text-gray-400">•</span>
                                            <span class="text-sm text-gray-700">Undergo security check at gate entry and exit</span>
                                        </li>
                                        <li class="flex items-start space-x-2">
                                            <span class="text-gray-400">•</span>
                                            <span class="text-sm text-gray-700">Use only service vehicles; no walking on main road</span>
                                        </li>
                                        <li class="flex items-start space-x-2">
                                            <span class="text-gray-400">•</span>
                                            <span class="text-sm text-gray-700">Wear proper attire and observe safety requirements</span>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Key Reminders Card -->
                <div class="bg-white border border-gray-200 rounded-lg shadow-sm overflow-hidden card-hover cursor-pointer" onclick="toggleAccordion('contractor-reminders')">
                    <div class="p-6">
                        <div class="flex items-center mb-4">
                            <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center mr-3">
                                <svg class="w-4 h-4 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                            </div>
                            <h3 class="text-lg font-semibold" style="color: #00072d;">Key Reminders</h3>
                        </div>
                        <p class="text-gray-600 mb-4 text-sm">Important guidelines</p>
                        
                        <div class="flex justify-between items-center">
                            <span class="font-medium text-gray-700">Important Reminders</span>
                            <svg id="arrow-contractor-reminders" class="w-5 h-5 transition-transform duration-300 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                            </svg>
                        </div>
                        
                        <div id="contractor-reminders" class="accordion-content">
                            <div class="mt-6 pt-4 border-t border-gray-200">
                                <div class="space-y-3">
                                    <div class="flex items-center space-x-3">
                                        <div class="w-6 h-6 bg-gray-200 rounded-full flex items-center justify-center">
                                            <span class="font-bold text-xs text-gray-600">1</span>
                                        </div>
                                        <p class="text-sm text-gray-700">File requests at least 1 day in advance</p>
                                    </div>
                                    
                                    <div class="flex items-center space-x-3">
                                        <div class="w-6 h-6 bg-gray-200 rounded-full flex items-center justify-center">
                                            <span class="font-bold text-xs text-gray-600">2</span>
                                        </div>
                                        <p class="text-sm text-gray-700">Weekend processing is limited - plan early</p>
                                    </div>
                                    
                                    <div class="flex items-center space-x-3">
                                        <div class="w-6 h-6 bg-gray-200 rounded-full flex items-center justify-center">
                                            <span class="font-bold text-xs text-gray-600">3</span>
                                        </div>
                                        <p class="text-sm text-gray-700">Keep Case ID copies for gate reference</p>
                                    </div>
                                    
                                    <div class="bg-red-50 border border-red-200 p-3 rounded-lg mt-4">
                                        <p class="text-sm font-medium text-red-800">⚠️ Non-compliance may result in delays, penalties, or project blacklisting</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Access Forms Card -->
                <div class="bg-white border border-gray-200 rounded-lg shadow-sm overflow-hidden card-hover cursor-pointer" onclick="toggleAccordion('contractor-forms')">
                    <div class="p-6">
                        <div class="flex items-center mb-4">
                            <div class="w-8 h-8 bg-indigo-100 rounded-lg flex items-center justify-center mr-3">
                                <svg class="w-4 h-4 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                                </svg>
                            </div>
                            <h3 class="text-lg font-semibold" style="color: #00072d;">Access Forms</h3>
                        </div>
                        <p class="text-gray-600 mb-4 text-sm">Filing procedures</p>
                        
                        <div class="flex justify-between items-center">
                            <span class="font-medium text-gray-700">How to file Access Forms?</span>
                            <svg id="arrow-contractor-forms" class="w-5 h-5 transition-transform duration-300 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                            </svg>
                        </div>
                        
                        <div id="contractor-forms" class="accordion-content">
                            <div class="mt-6 pt-4 border-t border-gray-200">
                                <div class="space-y-4">
                                    <div class="border-l-4 border-gray-300 pl-4">
                                        <h4 class="font-semibold mb-2 text-gray-900">Visitor Entry Request / Delivery</h4>
                                        <p class="text-sm mb-2 text-gray-600">Go to Agila Subic Bot → Service Request → Create Service Request → Select "Visitor Entry Request / Delivery."</p>
                                        <div class="flex items-start space-x-2">
                                            <span class="text-indigo-600">•</span>
                                            <p class="text-sm text-gray-700">Applies to vendors, suppliers, contractors, and their workers.</p>
                                        </div>
                                    </div>
                                    
                                    <div class="border-l-4 border-gray-300 pl-4">
                                        <h4 class="font-semibold mb-2 text-gray-900">Gatepass for Pull-Out</h4>
                                        <p class="text-sm mb-2 text-gray-600">Go to Agila Subic Bot → Service Request → Create Service Request → Select "Gatepass for Pull-Out."</p>
                                        <div class="flex items-start space-x-2">
                                            <span class="text-indigo-600">•</span>
                                            <p class="text-sm text-gray-700">Ensure that all guidelines are followed to avoid delays.</p>
                                        </div>
                                    </div>
                                    
                                    <div class="border-l-4 border-gray-300 pl-4">
                                        <h4 class="font-semibold mb-2 text-gray-900">HSE Induction</h4>
                                        <p class="text-sm mb-2 text-gray-600">Mandatory for contractors working on-site and visitors/vendors staying regularly or long-term.</p>
                                        <div class="flex items-start space-x-2">
                                            <span class="text-indigo-600">•</span>
                                            <p class="text-sm text-gray-700">Input all participant names--this serves as attendance.</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- PPE Requirements Card -->
                <div class="bg-white border border-gray-200 rounded-lg shadow-sm overflow-hidden card-hover cursor-pointer" onclick="toggleAccordion('contractor-ppe')">
                    <div class="p-6">
                        <div class="flex items-center mb-4">
                            <div class="w-8 h-8 bg-yellow-100 rounded-lg flex items-center justify-center mr-3">
                                <svg class="w-4 h-4 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.618 5.984A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path>
                                </svg>
                            </div>
                            <h3 class="text-lg font-semibold" style="color: #00072d;">PPE Requirements</h3>
                        </div>
                        <p class="text-gray-600 mb-4 text-sm">Dress code & safety gear</p>
                        
                        <div class="flex justify-between items-center">
                            <span class="font-medium text-gray-700">Dress code and PPE requirements?</span>
                            <svg id="arrow-contractor-ppe" class="w-5 h-5 transition-transform duration-300 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                            </svg>
                        </div>
                        
                        <div id="contractor-ppe" class="accordion-content">
                            <div class="mt-6 pt-4 border-t border-gray-200">
                                <div class="space-y-3">
                                    <p class="text-sm text-gray-700">Proper attire and PPE (Personal Protective Equipment) are required.</p>
                                    <div class="bg-red-50 border border-red-200 p-3 rounded-lg flex items-start space-x-2">
                                        <span class="text-red-600">•</span>
                                        <p class="text-sm text-gray-700">Non-compliance may result in denied entry.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Equipment & Vehicles Card -->
                <div class="bg-white border border-gray-200 rounded-lg shadow-sm overflow-hidden card-hover cursor-pointer" onclick="toggleAccordion('contractor-equipment')">
                    <div class="p-6">
                        <div class="flex items-center mb-4">
                            <div class="w-8 h-8 bg-gray-100 rounded-lg flex items-center justify-center mr-3">
                                <svg class="w-4 h-4 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"></path>
                                </svg>
                            </div>
                            <h3 class="text-lg font-semibold" style="color: #00072d;">Equipment & Vehicles</h3>
                        </div>
                        <p class="text-gray-600 mb-4 text-sm">Bringing tools and vehicles</p>
                        
                        <div class="flex justify-between items-center">
                            <span class="font-medium text-gray-700">Can I bring tools, equipment, or vehicles?</span>
                            <svg id="arrow-contractor-equipment" class="w-5 h-5 transition-transform duration-300 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                            </svg>
                        </div>
                        
                        <div id="contractor-equipment" class="accordion-content">
                            <div class="mt-6 pt-4 border-t border-gray-200">
                                <div class="space-y-3">
                                    <p class="text-sm text-gray-700">Yes, but all must be declared in the request form.</p>
                                    <div class="bg-yellow-50 border border-yellow-200 p-3 rounded-lg flex items-start space-x-2">
                                        <span class="text-yellow-600">⚠️</span>
                                        <p class="text-sm text-gray-700">Mismatched or undeclared items/plate numbers may cause gate delays.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Schedule Information Card -->
        <div class="mb-8">
            <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-8">
                <div class="text-center mb-8">
                    <h2 class="text-2xl font-bold text-gray-900 mb-2">Schedule Information</h2>
                    <div class="w-16 h-0.5 bg-blue-600 mx-auto"></div>
                </div>
                <div class="grid md:grid-cols-2 gap-8">
                    <div>
                        <h3 class="text-lg font-semibold text-gray-900 mb-4">General Information</h3>
                        <ul class="space-y-3 text-gray-600">
                            <li class="flex items-start space-x-2">
                                <span class="text-blue-600 font-bold">•</span>
                                <span class="text-sm">Visitor Entry Pass is valid for 3--7 days</span>
                            </li>
                            <li class="flex items-start space-x-2">
                                <span class="text-blue-600 font-bold">•</span>
                                <span class="text-sm">Requests must be filed at least 1 day in advance</span>
                            </li>
                            <li class="flex items-start space-x-2">
                                <span class="text-blue-600 font-bold">•</span>
                                <span class="text-sm">Visitors coming more than once a week must undergo Safety & Security Induction</span>
                            </li>
                            <li class="flex items-start space-x-2">
                                <span class="text-blue-600 font-bold">•</span>
                                <span class="text-sm">Present the Case ID at Security for verification</span>
                            </li>
                            <li class="flex items-start space-x-2">
                                <span class="text-blue-600 font-bold">•</span>
                                <span class="text-sm">File requests early to avoid delays, especially on weekends when processing is limited</span>
                            </li>
                        </ul>
                    </div>
                    
                    <div>
                        <h3 class="text-lg font-semibold text-gray-900 mb-4">Contractors & Subcontractors Schedule</h3>
                        <div class="space-y-4">
                            <div class="bg-green-50 border border-green-200 p-4 rounded-lg">
                                <h4 class="font-semibold text-green-700 mb-2">Visitor Entry / Delivery</h4>
                                <p class="text-sm text-green-600">Monday--Saturday, 8:00am -- 5:00pm</p>
                                <p class="text-red-600 text-sm font-medium">(No Sunday Delivery)</p>
                            </div>
                            
                            <div class="bg-blue-50 border border-blue-200 p-4 rounded-lg">
                                <h4 class="font-semibold text-blue-700 mb-2">Pull-Out of Materials/Equipment</h4>
                                <ul class="text-sm text-blue-600 space-y-1">
                                    <li>Monday--Friday, 8:00am -- 5:00pm</li>
                                    <li>Saturday, 8:00am -- 12nn (Half-day only)</li>
                                </ul>
                                <p class="text-red-600 text-sm font-medium mt-2">No Sunday Pull-Out</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer Contact Card -->
        <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-8 text-center">
            <div class="flex items-center justify-center mb-4">
                <div class="w-12 h-12 bg-blue-50 border border-blue-200 rounded-lg flex items-center justify-center mr-4">
                    <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path>
                    </svg>
                </div>
                <div>
                    <h3 class="text-xl font-semibold text-gray-900">Need Assistance?</h3>
                    <p class="text-gray-600">Contact <strong class="text-blue-600">Agila Facility Management System Specialist </strong></p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // HSE Bulletins System with Persistence
        const defaultImages = [
            'https://pfst.cf2.poecdn.net/base/image/d8e19f7723209cbe33dd66b54895f831f6d56326426d5fb947e79fd60fdf5d3f?w=649&h=890',
            'https://pfst.cf2.poecdn.net/base/image/e3276591bd9f5afb2a4a29fe95e87b209845d18c805f78708bf49c2f05c7b9d2?w=649&h=900',
            'https://pfst.cf2.poecdn.net/base/image/303685611f751d8f108004910c1e6d5d6fd23ba86e4d333da49751e14eb987a8?w=642&h=894',
            'https://pfst.cf2.poecdn.net/base/image/c02f9ac4524f260060be5394af6b426a566d5d510d713544e57e35647069a993?w=644&h=885',
            'https://pfst.cf2.poecdn.net/base/image/5fc7ca9a44cc7e7a786f729c42d8535d73e4fea09131d9d54effa2cac0ecee89?w=637&h=898',
            'https://pfst.cf2.poecdn.net/base/image/6603313ed2fa69635ad235526c0e1ea7661710e9e1a4e9cac110754a34f69e2f?w=602&h=907',
            'https://pfst.cf2.poecdn.net/base/image/7bb4ce44837326b3a8b4a98b10bc83d86a70dd3290391aa09a7b5e60fa4a7e55?w=613&h=902',
            'https://pfst.cf2.poecdn.net/base/image/74f45d411c51d19215145fe04f59c17fcf8b6aa4bfec823494cac54e3157fa3e?w=612&h=892',
            'https://pfst.cf2.poecdn.net/base/image/6b1ce99cbed59b9cd5aa17fda4f1928b06b445a5823a52bb47b4b8e612176770?w=584&h=905',
            'https://pfst.cf2.poecdn.net/base/image/4d96e9cab08c5685a2e119402f294606e4bb55db36c7d020124a4c0259dc6b5c?w=565&h=799',
            'https://pfst.cf2.poecdn.net/base/image/3a63faf7ef53934a69c41c58d615676c936b6539de80749aa890358c22a57feb?w=757&h=862',
            'https://pfst.cf2.poecdn.net/base/image/ce9c2c0a2a75c7e4bcdbd4fce912a5ffc1bccf1971c9196214494c1ea36c58a4?w=630&h=904'
        ];

        let hseImages = [...defaultImages];
        let currentImageIndex = 0;
        let autoAdvanceInterval = null;
        let progressInterval = null;
        let isAutoAdvancing = true;
        let advanceDuration = 8; // seconds
        const settingsPassword = "agila2025"; // Change this to your desired password

        // IndexedDB Database Management
        let db = null;
        const DB_NAME = 'AgilaHSEDatabase';
        const DB_VERSION = 1;
        const STORE_NAME = 'images';

        function initDatabase() {
            return new Promise((resolve, reject) => {
                const request = indexedDB.open(DB_NAME, DB_VERSION);
                
                request.onerror = () => {
                    console.log('IndexedDB error:', request.error);
                    updateStorageStatus(false);
                    reject(request.error);
                };
                
                request.onsuccess = () => {
                    db = request.result;
                    console.log('IndexedDB initialized successfully');
                    updateStorageStatus(true);
                    resolve(db);
                };
                
                request.onupgradeneeded = (event) => {
                    db = event.target.result;
                    
                    // Create object store for images
                    if (!db.objectStoreNames.contains(STORE_NAME)) {
                        const store = db.createObjectStore(STORE_NAME, { keyPath: 'id' });
                        store.createIndex('timestamp', 'timestamp', { unique: false });
                    }
                };
            });
        }

        function saveImages() {
            return new Promise((resolve, reject) => {
                if (!db) {
                    // Fallback to memory only
                    updateStorageStatus(false);
                    resolve(false);
                    return;
                }

                const transaction = db.transaction([STORE_NAME], 'readwrite');
                const store = transaction.objectStore(STORE_NAME);
                
                const data = {
                    id: 'hse_images_data',
                    images: hseImages,
                    settings: { advanceDuration },
                    timestamp: new Date().toISOString()
                };
                
                const request = store.put(data);
                
                request.onsuccess = () => {
                    console.log('Images saved to IndexedDB');
                    updateStorageStatus(true);
                    resolve(true);
                };
                
                request.onerror = () => {
                    console.log('Error saving to IndexedDB:', request.error);
                    updateStorageStatus(false);
                    resolve(false);
                };
            });
        }

        function loadSavedData() {
            return new Promise((resolve, reject) => {
                if (!db) {
                    updateStorageStatus(false);
                    resolve(false);
                    return;
                }

                const transaction = db.transaction([STORE_NAME], 'readonly');
                const store = transaction.objectStore(STORE_NAME);
                const request = store.get('hse_images_data');
                
                request.onsuccess = () => {
                    const result = request.result;
                    if (result) {
                        if (result.images && Array.isArray(result.images) && result.images.length > 0) {
                            hseImages = result.images;
                            console.log('Loaded saved HSE images from IndexedDB');
                        }
                        
                        if (result.settings && result.settings.advanceDuration) {
                            advanceDuration = result.settings.advanceDuration;
                        }
                        
                        updateStorageStatus(true);
                        resolve(true);
                    } else {
                        console.log('No saved data found, using defaults');
                        updateStorageStatus(true);
                        resolve(false);
                    }
                };
                
                request.onerror = () => {
                    console.log('Error loading from IndexedDB:', request.error);
                    updateStorageStatus(false);
                    resolve(false);
                };
            });
        }

        function clearSavedData() {
            return new Promise((resolve, reject) => {
                if (!db) {
                    resolve(false);
                    return;
                }

                const transaction = db.transaction([STORE_NAME], 'readwrite');
                const store = transaction.objectStore(STORE_NAME);
                const request = store.delete('hse_images_data');
                
                request.onsuccess = () => {
                    console.log('Saved data cleared from IndexedDB');
                    resolve(true);
                };
                
                request.onerror = () => {
                    console.log('Error clearing IndexedDB:', request.error);
                    resolve(false);
                };
            });
        }

        function updateStorageStatus(available) {
            const statusDiv = document.getElementById('storageStatus');
            const indicator = document.getElementById('storageIndicator');
            const text = document.getElementById('storageText');
            
            if (available) {
                statusDiv.className = 'mt-4 p-3 rounded-lg bg-green-50 border border-green-200';
                indicator.className = 'w-2 h-2 rounded-full bg-green-500';
                text.textContent = 'Storage available - images will persist';
                text.className = 'text-xs text-green-600';
            } else {
                statusDiv.className = 'mt-4 p-3 rounded-lg bg-orange-50 border border-orange-200';
                indicator.className = 'w-2 h-2 rounded-full bg-orange-500';
                text.textContent = 'Session only - use export/import to save images';
                text.className = 'text-xs text-orange-600';
            }
        }

        function exportImages() {
            const data = {
                images: hseImages,
                settings: { advanceDuration },
                exportDate: new Date().toISOString(),
                version: '1.0'
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `agila-hse-images-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
            
            showUploadStatus('Images list exported successfully!', 'success');
            setTimeout(() => {
                const statusDiv = document.getElementById('uploadStatus');
                statusDiv.classList.add('hidden');
            }, 3000);
        }

        function handleImportFile(input) {
            const file = input.files[0];
            if (file) {
                importImages(file);
                input.value = ''; // Clear the input
            }
        }

        function importImages(file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    if (data.images && Array.isArray(data.images)) {
                        hseImages = data.images;
                        if (data.settings && data.settings.advanceDuration) {
                            advanceDuration = data.settings.advanceDuration;
                            document.getElementById('advanceDuration').value = advanceDuration;
                        }
                        saveImages();
                        updateImagesList();
                        showUploadStatus('Images imported successfully!', 'success');
                        
                        // Auto-hide success message after 3 seconds
                        setTimeout(() => {
                            const statusDiv = document.getElementById('uploadStatus');
                            statusDiv.classList.add('hidden');
                        }, 3000);
                    } else {
                        showUploadStatus('Invalid import file format.', 'error');
                    }
                } catch (error) {
                    showUploadStatus('Error reading import file.', 'error');
                }
            };
            reader.readAsText(file);
        }

        function resetToDefault() {
            hseImages = [...defaultImages];
            advanceDuration = 8;
            document.getElementById('advanceDuration').value = advanceDuration;
            saveImages();
            updateImagesList();
            showUploadStatus('Reset to default images successfully!', 'success');
            
            setTimeout(() => {
                const statusDiv = document.getElementById('uploadStatus');
                statusDiv.classList.add('hidden');
            }, 3000);
        }

        // Initialize database and load data on page load
        window.addEventListener('load', async function() {
            try {
                // Initialize IndexedDB first
                await initDatabase();
                // Then load saved data
                await loadSavedData();
            } catch (error) {
                console.log('Database initialization failed, using session memory only');
                updateStorageStatus(false);
            }
            
            setTimeout(() => {
                showHSEPopup();
            }, 2000); // Show after 2 seconds
        });

        function showHSEPopup() {
            const popup = document.getElementById('hsePopup');
            if (hseImages.length === 0) return;
            
            popup.classList.remove('hidden');
            // Start with the latest image (last in array)
            currentImageIndex = hseImages.length - 1;
            updateImage();
            updateImageCounter();
            
            if (isAutoAdvancing) {
                startAutoAdvance();
            }
        }

        function closeHSEPopup() {
            const popup = document.getElementById('hsePopup');
            popup.classList.add('hidden');
            stopAutoAdvance();
        }

        function updateImage() {
            const imageElement = document.getElementById('hseImage');
            const progressBar = document.getElementById('progressBar');
            
            if (hseImages[currentImageIndex]) {
                imageElement.src = hseImages[currentImageIndex];
                progressBar.style.width = '0%';
            }
        }

        function updateImageCounter() {
            document.getElementById('currentImageIndex').textContent = currentImageIndex + 1;
            document.getElementById('totalImages').textContent = hseImages.length;
        }

        function nextImage() {
            currentImageIndex = (currentImageIndex + 1) % hseImages.length;
            updateImage();
            updateImageCounter();
            
            if (isAutoAdvancing) {
                stopAutoAdvance();
                startAutoAdvance();
            }
        }

        function previousImage() {
            currentImageIndex = currentImageIndex === 0 ? hseImages.length - 1 : currentImageIndex - 1;
            updateImage();
            updateImageCounter();
            
            if (isAutoAdvancing) {
                stopAutoAdvance();
                startAutoAdvance();
            }
        }

        function startAutoAdvance() {
            stopAutoAdvance();
            
            let progress = 0;
            const progressBar = document.getElementById('progressBar');
            
            progressInterval = setInterval(() => {
                progress += 100 / (advanceDuration * 10);
                progressBar.style.width = progress + '%';
            }, 100);
            
            autoAdvanceInterval = setTimeout(() => {
                nextImage();
                if (isAutoAdvancing) {
                    startAutoAdvance();
                }
            }, advanceDuration * 1000);
        }

        function stopAutoAdvance() {
            if (autoAdvanceInterval) {
                clearTimeout(autoAdvanceInterval);
                autoAdvanceInterval = null;
            }
            if (progressInterval) {
                clearInterval(progressInterval);
                progressInterval = null;
            }
        }

        function toggleAutoAdvance() {
            const btn = document.getElementById('autoAdvanceBtn');
            isAutoAdvancing = !isAutoAdvancing;
            
            if (isAutoAdvancing) {
                btn.textContent = 'Pause';
                btn.classList.remove('bg-green-500', 'hover:bg-green-600');
                btn.classList.add('bg-blue-500', 'hover:bg-blue-600');
                startAutoAdvance();
            } else {
                btn.textContent = 'Play';
                btn.classList.remove('bg-blue-500', 'hover:bg-blue-600');
                btn.classList.add('bg-green-500', 'hover:bg-green-600');
                stopAutoAdvance();
            }
        }

        // Settings Panel Functions
        function openSettings() {
            document.getElementById('settingsPanel').classList.add('open');
        }

        function closeSettings() {
            document.getElementById('settingsPanel').classList.remove('open');
            document.getElementById('passwordSection').classList.remove('hidden');
            document.getElementById('settingsContent').classList.add('hidden');
            document.getElementById('settingsPassword').value = '';
            document.getElementById('passwordError').classList.add('hidden');
        }

        function verifyPassword() {
            const password = document.getElementById('settingsPassword').value;
            const errorDiv = document.getElementById('passwordError');
            
            if (password === settingsPassword) {
                document.getElementById('passwordSection').classList.add('hidden');
                document.getElementById('settingsContent').classList.remove('hidden');
                updateImagesList();
                document.getElementById('advanceDuration').value = advanceDuration;
                errorDiv.classList.add('hidden');
            } else {
                errorDiv.classList.remove('hidden');
                document.getElementById('settingsPassword').value = '';
            }
        }

        // Picture Upload Function
        async function uploadImage() {
            const fileInput = document.getElementById('imageUpload');
            const statusDiv = document.getElementById('uploadStatus');
            
            if (!fileInput.files[0]) {
                showUploadStatus('Please select an image file.', 'error');
                return;
            }
            
            const file = fileInput.files[0];
            
            // Check if it's an image
            if (!file.type.startsWith('image/')) {
                showUploadStatus('Please select a valid image file.', 'error');
                return;
            }
            
            // Check file size (max 10MB for better support)
            if (file.size > 10 * 1024 * 1024) {
                showUploadStatus('Image size must be less than 10MB.', 'error');
                return;
            }
            
            showUploadStatus('Uploading and saving image...', 'loading');
            
            const reader = new FileReader();
            reader.onload = async function(e) {
                const imageDataUrl = e.target.result;
                // Add to the end of array (newest first in display)
                hseImages.push(imageDataUrl);
                fileInput.value = '';
                
                // Save to IndexedDB
                const saved = await saveImages();
                updateImagesList();
                
                if (saved) {
                    showUploadStatus('Image uploaded and saved to local storage!', 'success');
                } else {
                    showUploadStatus('Image uploaded (session only - export to save permanently)', 'success');
                }
                
                // Auto-hide success message after 3 seconds
                setTimeout(() => {
                    const statusDiv = document.getElementById('uploadStatus');
                    statusDiv.classList.add('hidden');
                }, 3000);
            };
            
            reader.onerror = function() {
                showUploadStatus('Error reading image file.', 'error');
            };
            
            reader.readAsDataURL(file);
        }
        
        function showUploadStatus(message, type) {
            const statusDiv = document.getElementById('uploadStatus');
            statusDiv.classList.remove('hidden');
            statusDiv.textContent = message;
            
            // Remove previous type classes
            statusDiv.classList.remove('text-red-600', 'text-green-600', 'text-blue-600');
            
            if (type === 'error') {
                statusDiv.classList.add('text-red-600');
            } else if (type === 'success') {
                statusDiv.classList.add('text-green-600');
            } else if (type === 'loading') {
                statusDiv.classList.add('text-blue-600');
            }
        }

        function addNewImage() {
            const url = document.getElementById('newImageUrl').value.trim();
            if (url && !hseImages.includes(url)) {
                hseImages.push(url);
                document.getElementById('newImageUrl').value = '';
                saveImages(); // Auto-save after adding
                updateImagesList();
                showUploadStatus('Image URL added and saved successfully!', 'success');
                
                setTimeout(() => {
                    const statusDiv = document.getElementById('uploadStatus');
                    statusDiv.classList.add('hidden');
                }, 3000);
            }
        }

        function removeImage(index) {
            if (hseImages.length > 1) {
                hseImages.splice(index, 1);
                if (currentImageIndex >= hseImages.length) {
                    currentImageIndex = 0;
                }
                saveImages(); // Auto-save after removal
                updateImagesList();
                updateImageCounter();
                showUploadStatus('Image removed successfully!', 'success');
                
                setTimeout(() => {
                    const statusDiv = document.getElementById('uploadStatus');
                    statusDiv.classList.add('hidden');
                }, 3000);
            }
        }

        function updateDuration() {
            const newDuration = parseInt(document.getElementById('advanceDuration').value);
            if (newDuration >= 3 && newDuration <= 30) {
                advanceDuration = newDuration;
                saveImages(); // Save settings too
                if (isAutoAdvancing && !document.getElementById('hsePopup').classList.contains('hidden')) {
                    stopAutoAdvance();
                    startAutoAdvance();
                }
                showUploadStatus('Duration updated and saved!', 'success');
                
                setTimeout(() => {
                    const statusDiv = document.getElementById('uploadStatus');
                    statusDiv.classList.add('hidden');
                }, 3000);
            }
        }

        function updateImagesList() {
            const list = document.getElementById('imagesList');
            list.innerHTML = '';
            
            hseImages.forEach((url, index) => {
                const item = document.createElement('div');
                item.className = 'flex items-center justify-between p-2 bg-gray-50 rounded text-xs';
                
                // Show different indicator for uploaded vs default images
                const isUploaded = !defaultImages.includes(url);
                const indicator = isUploaded ? '<span class="text-green-500">📁</span>' : '<span class="text-blue-500">🔗</span>';
                
                item.innerHTML = `
                    <div class="flex items-center space-x-2 flex-1 mr-2">
                        ${indicator}
                        <span class="truncate">Image ${index + 1}${isUploaded ? ' (Uploaded)' : ''}</span>
                    </div>
                    <button onclick="removeImage(${index})" class="text-red-500 hover:text-red-700 ${hseImages.length <= 1 ? 'opacity-50 cursor-not-allowed' : ''}" ${hseImages.length <= 1 ? 'disabled' : ''}>
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                        </svg>
                    </button>
                `;
                list.appendChild(item);
            });
        }

        // Accordion functionality
        function toggleAccordion(id) {
            const content = document.getElementById(id);
            const arrow = document.getElementById('arrow-' + id);
            
            if (!content || !arrow) return;
            
            const isOpen = content.classList.contains('open');
            
            if (isOpen) {
                content.classList.remove('open');
                arrow.style.transform = 'rotate(0deg)';
            } else {
                content.classList.add('open');
                arrow.style.transform = 'rotate(180deg)';
            }
        }

        // Search functionality
        function searchFAQs() {
            const searchInput = document.getElementById('searchInput');
            const searchTerm = searchInput.value.toLowerCase().trim();
            const clearButton = document.getElementById('clearSearch');
            const searchResults = document.getElementById('searchResults');
            const noResults = document.getElementById('noResults');
            const resultCount = document.getElementById('resultCount');
            
            if (searchTerm) {
                clearButton.classList.remove('hidden');
            } else {
                clearButton.classList.add('hidden');
            }
            
            const faqCards = document.querySelectorAll('[onclick^="toggleAccordion"]');
            let visibleCount = 0;
            
            faqCards.forEach(card => {
                const title = card.querySelector('h3');
                const content = card.querySelector('.accordion-content');
                const questionText = card.querySelector('span');
                
                if (title && questionText) {
                    const titleText = title.textContent.toLowerCase();
                    const questionTextContent = questionText.textContent.toLowerCase();
                    const contentText = content ? content.textContent.toLowerCase() : '';
                    
                    const matches = titleText.includes(searchTerm) || 
                                   questionTextContent.includes(searchTerm) || 
                                   contentText.includes(searchTerm);
                    
                    if (searchTerm === '' || matches) {
                        card.style.display = 'block';
                        visibleCount++;
                    } else {
                        card.style.display = 'none';
                    }
                }
            });
            
            if (searchTerm) {
                searchResults.classList.remove('hidden');
                resultCount.textContent = visibleCount;
                
                if (visibleCount === 0) {
                    noResults.classList.remove('hidden');
                } else {
                    noResults.classList.add('hidden');
                }
            } else {
                searchResults.classList.add('hidden');
                noResults.classList.add('hidden');
            }
        }

        function clearSearch() {
            const searchInput = document.getElementById('searchInput');
            const clearButton = document.getElementById('clearSearch');
            const searchResults = document.getElementById('searchResults');
            const noResults = document.getElementById('noResults');
            
            searchInput.value = '';
            clearButton.classList.add('hidden');
            searchResults.classList.add('hidden');
            noResults.classList.add('hidden');
            
            const faqCards = document.querySelectorAll('[onclick^="toggleAccordion"]');
            faqCards.forEach(card => {
                card.style.display = 'block';
            });
            
            searchInput.focus();
        }

        // Initialize search functionality
        document.addEventListener('DOMContentLoaded', function() {
            const searchInput = document.getElementById('searchInput');
            const clearButton = document.getElementById('clearSearch');
            const settingsPassword = document.getElementById('settingsPassword');
            
            if (searchInput) {
                searchInput.addEventListener('input', searchFAQs);
                searchInput.addEventListener('keydown', function(e) {
                    if (e.key === 'Escape') {
                        clearSearch();
                    }
                });
            }
            
            if (clearButton) {
                clearButton.addEventListener('click', clearSearch);
            }

            if (settingsPassword) {
                settingsPassword.addEventListener('keydown', function(e) {
                    if (e.key === 'Enter') {
                        verifyPassword();
                    }
                });
            }
        });

        // Make functions globally available
        window.toggleAccordion = toggleAccordion;
        window.searchFAQs = searchFAQs;
        window.clearSearch = clearSearch;
        window.showHSEPopup = showHSEPopup;
        window.closeHSEPopup = closeHSEPopup;
        window.nextImage = nextImage;
        window.previousImage = previousImage;
        window.toggleAutoAdvance = toggleAutoAdvance;
        window.openSettings = openSettings;
        window.closeSettings = closeSettings;
        window.verifyPassword = verifyPassword;
        window.addNewImage = addNewImage;
        window.removeImage = removeImage;
        window.updateDuration = updateDuration;
        window.uploadImage = uploadImage;
        window.exportImages = exportImages;
        window.importImages = importImages;
        window.handleImportFile = handleImportFile;
        window.resetToDefault = resetToDefault;
    </script>
</body>
</html>
